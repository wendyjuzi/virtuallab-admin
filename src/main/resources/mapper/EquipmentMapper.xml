<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edu.virtuallab.experiment.dao.EquipmentMapper">
    <select id="selectByDepartment" resultType="com.edu.virtuallab.experiment.model.Equipment">
        SELECT e.*
        FROM equipment e
        JOIN laboratories l ON e.lab_id = l.lab_id
        WHERE l.department = #{department}
        <if test="keyword != null and keyword != ''">
            AND (e.equipment_name LIKE CONCAT('%', #{keyword}, '%')
            OR e.model LIKE CONCAT('%', #{keyword}, '%')
            OR e.category LIKE CONCAT('%', #{keyword}, '%')
            OR e.serial_number LIKE CONCAT('%', #{keyword}, '%'))
        </if>
    </select>
</mapper>
# 用户注册状态配置说明

## 修改内容

在用户注册时，确保所有新注册用户的状态都设置为正常状态（status = 1）。

## 修改位置

**文件**: `src/main/java/com/edu/virtuallab/auth/service/impl/UserServiceImpl.java`

**方法**: `register(UserRegisterDTO dto)`

**修改内容**: 在创建用户对象时，显式设置 `user.setStatus(User.STATUS_NORMAL)`

## 修改前代码

```java
User user = new User();
user.setUsername(dto.getUsername());
user.setPassword(dto.getPassword());
user.setPhone(dto.getPhone());
user.setEmail(dto.getEmail());
user.setRealName(dto.getRealName());
user.setStudentId(dto.getStudentId());
user.setDepartment(dto.getDepartment());
user.setMajor(dto.getMajor());
user.setGrade(dto.getGrade());
user.setClassName(dto.getClassName());
// 没有设置status字段
int userResult = userDao.insert(user);
```

## 修改后代码

```java
User user = new User();
user.setUsername(dto.getUsername());
user.setPassword(dto.getPassword());
user.setPhone(dto.getPhone());
user.setEmail(dto.getEmail());
user.setRealName(dto.getRealName());
user.setStudentId(dto.getStudentId());
user.setDepartment(dto.getDepartment());
user.setMajor(dto.getMajor());
user.setGrade(dto.getGrade());
user.setClassName(dto.getClassName());
user.setStatus(User.STATUS_NORMAL); // 设置用户状态为正常(1)
int userResult = userDao.insert(user);
```

## 用户状态说明

根据 `User.java` 中定义的状态常量：

- `STATUS_DISABLED = 0` - 禁用状态
- `STATUS_NORMAL = 1` - 正常状态（默认）
- `STATUS_LOCKED = 2` - 锁定状态

## 数据库默认值

数据库表 `user` 中的 `status` 字段已经设置了默认值：

```sql
`status` TINYINT DEFAULT 1 COMMENT '状态：0-禁用 1-正常 2-锁定'
```

## 为什么需要显式设置

虽然数据库有默认值，但在代码中显式设置有以下好处：

1. **代码明确性**: 明确表示新注册用户的状态
2. **一致性**: 确保所有注册的用户都有相同的初始状态
3. **可维护性**: 如果将来需要修改默认状态，只需要修改代码中的常量
4. **调试友好**: 在调试时可以清楚地看到状态设置

## 影响范围

此修改影响所有通过注册接口创建的用户：

- 普通用户注册
- 管理员注册
- 通过API注册的用户

## 验证方法

1. 注册新用户
2. 查询数据库中的用户记录
3. 确认 `status` 字段值为 1

## 相关文件

- `src/main/java/com/edu/virtuallab/auth/model/User.java` - 用户模型和状态常量
- `src/main/java/com/edu/virtuallab/auth/controller/UserController.java` - 用户注册接口
- `src/main/resources/sql/init_auth_tables.sql` - 数据库表结构 